<<<<<<< HEAD
var certificateImage={printCertificate:function(e){var t=document.getElementById(e).innerHTML,o=document.body.innerHTML;document.body.innerHTML=t,window.print(),document.body.innerHTML=o,certificateImage.enableDownloadShareBtns()},enableDownloadShareBtns:function(){jQuery("#download-popover").popover({trigger:"focus",html:!0,content:jQuery("#download-popover-content").html()}),jQuery("#sharing-popover").popover({trigger:"focus",html:!0,content:jQuery("#sharing-popover-content").html()}),jQuery("#copyurl").popover()},uploadImage:function(e){var t=!1,o=jQuery("#certificateId").val();return jQuery.ajax({url:certRootUrl+"index.php?option=com_tjcertificate&task=certificate.uploadCertificate",type:"POST",data:{image:e,certificateId:o},success:function(e){t=e;var o=jQuery("#certificateId").val(),r=certRootUrl+"media/com_tjcertificate/certificates/",n=document.createElement("img");jQuery("#certificateContent").hide(),n.src=r+o+".png",jQuery("#previewImage").append(n),setTimeout(function(){screen.width<1200&&(viewport=document.querySelector("meta[name=viewport]"),viewport.setAttribute("content","width=device-width")),jQuery.LoadingOverlay("hide")},1e3)}}),t},generateImage:function(e){screen.width<1200&&(viewport=document.querySelector("meta[name=viewport]"),viewport.setAttribute("content","width=1200px")),jQuery.LoadingOverlay("show",{image:"media/com_tjcertificate/images/loader/loader.gif"}),html2canvas(e,{scrollX:0,scrollY:-window.scrollY,allowTaint:!0,useCORS:!0}).then(function(e){certificateImage.enableDownloadShareBtns(),certificateImage.uploadImage(e.toDataURL("image/png"))})},copyUrl:function(e){e="#"+e;var t=document.createElement("input"),o=jQuery(e).attr("data-alt-url");jQuery(e).popover("show"),document.body.appendChild(t),t.value=o,t.select(),document.execCommand("copy"),document.body.removeChild(t),setTimeout(function(){jQuery(e).popover("hide")},1e3)}};
=======
var certificate={validateFile:function(e){if("file"!=jQuery(e).attr("type"))return!1;jQuery("#system-message-container").empty();var r=jQuery(e)[0].files[0],t=r.type,a=r.name.split("."),s=allowedAttachments.split(","),i=0,n=new Array;return""===a[a.length-1]&&null===a[a.length-1]||-1!=jQuery.inArray(t,s)||(i="1",n.push(Joomla.JText._("COM_TJCERTIFICATE_MEDIA_INVALID_FILE_TYPE"))),r.size>1024*attachmentMaxSize*1024&&(i="1",n.push(Joomla.JText._("COM_TJCERTIFICATE_MEDIA_UPLOAD_ERROR")),console.log("COM_TIMELOG_FILE_SIZE_ERROR")),i?(Joomla.renderMessages({error:n}),jQuery("html, body").animate({scrollTop:0},500),!1):void 0},deleteAttachment:function(e){if(1==confirm(Joomla.JText._("COM_TJCERTIFICATE_CONFIRM_DELETE_ATTACHMENT"))){var r={};if(""==e||void 0===e)return!1;r.certificateId=jQuery(e).attr("data-aid"),r.mediaId=jQuery(e).attr("data-mid"),tjCertificateService.deleteAttachment(r).fail(function(e){var r={error:[e.responseText]};certificate.renderMessage(r)}).done(function(r){if(!r.success&&r.message){var t={error:[r.message]};certificate.renderMessage(t)}r.messages&&certificate.renderMessage(r.messages),r.success&&certificate.renderMessage(r.message),jQuery(e).closest("span.fileupload").remove()})}},deleteItem:function(e,r){if(1==confirm(Joomla.JText._("COM_TJCERTIFICATE_DELETE_CERTIFICATE_MESSAGE"))){var t={};if(""==e||void 0===e)return!1;t.certificateId=e,tjCertificateService.deleteItem(t).fail(function(e){var r={error:[e.responseText]};certificate.renderMessage(r)}).done(function(e){if(!e.success&&e.message){var t={error:[e.message]};certificate.renderMessage(t)}e.messages&&certificate.renderMessage(e.messages),e.success&&certificate.renderMessage(e.message),jQuery(r).closest("tr").remove()})}},renderMessage:function(e){Joomla.renderMessages({"alert alert-success":[e]}),jQuery("html, body").animate({scrollTop:0},2e3)},validationEndDate:function(e){var r=jQuery(e).val(),t=jQuery("#jform_issued_on").val();jQuery(document).ready(function(){document.formvalidator.setHandler("expdate",function(e){return!(t>r)||(certificate.renderMessage(Joomla.JText._("COM_TJCERTIFICATE_EXPIRY_DATE_VALIDATION_MESSAGE")),jQuery("#jform_expired_on").val(""),!1)})})},getAgencyUsers:function(e){var r={},t=jQuery("#jform_assigned_user_id"),a=jQuery("#assigned_user_id").val();r.agency_id=jQuery(e).val(),tjCertificateService.getAgencyUsers(r).fail(function(e){var r={error:[e.responseText]};Joomla.renderMessage(r)}).done(function(e){if(!e)return!1;if(e.success){t.empty(),t.trigger("liszt:updated");for(var r=e.data,s=0;s<r.length;++s)selectOption="",a==r[s].value&&(selectOption=' selected="selected" '),op="<option value='"+r[s].value+"' "+selectOption+" > "+r[s].text+"</option>",t.append(op);t.trigger("liszt:updated")}})}};
>>>>>>> upstream/release-1.0.6
